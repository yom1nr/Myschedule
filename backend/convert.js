const fs = require('fs');

// 1. ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö
const rawData = fs.readFileSync('raw_data.txt', 'utf-8');

// 2. ‡πÅ‡∏¢‡∏Å‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î ‡πÅ‡∏•‡∏∞‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô JSON
const courses = rawData
  .split('\n') // ‡πÅ‡∏¢‡∏Å‡∏ó‡∏µ‡∏•‡∏∞‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î
  .filter(line => line.trim() !== '') // ‡∏ï‡∏±‡∏î‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ß‡πà‡∏≤‡∏á‡∏ó‡∏¥‡πâ‡∏á
  .map(line => {
    // ‡πÅ‡∏Å‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢ "..."
    // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö: "‡∏£‡∏´‡∏±‡∏™","‡∏ä‡∏∑‡πà‡∏≠","‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Å‡∏¥‡∏ï","‡πÄ‡∏ß‡∏•‡∏≤"
    const regex = /"([^"]*)","([^"]*)","([^"]*)","([^"]*)"/;
    const match = line.match(regex);

    if (match) {
      return {
        code: match[1],   // ‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà 1
        name: match[2],   // ‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà 2
        credit: parseInt(match[3]) || 0, // ‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà 3 (‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç)
        time: match[4]    // ‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà 4
      };
    }
    return null;
  })
  .filter(item => item !== null); // ‡∏Å‡∏£‡∏≠‡∏á‡∏≠‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡∏∞‡πÑ‡∏°‡πà‡∏≠‡∏≠‡∏Å‡∏ó‡∏¥‡πâ‡∏á

// 3. ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏•‡∏á‡πÑ‡∏ü‡∏•‡πå courses.json
fs.writeFileSync('courses.json', JSON.stringify(courses, null, 2));

console.log(`‚úÖ ‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡πÑ‡∏î‡πâ‡∏ß‡∏¥‡∏ä‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${courses.length} ‡∏ß‡∏¥‡∏ä‡∏≤`);
console.log(`üìÅ ‡πÑ‡∏ü‡∏•‡πå‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏µ‡πà: courses.json`);